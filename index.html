<!DOCTYPE html><html lang="ko"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>FrameQuote â€” Global Production Estimator</title><style>:root{--bg0:#070a10;--bg1:#0c1422;--glass:#0f1a2add;--ink:#eaf1ff;--muted:#a8b6d6;--accent:#5dd5ff;--accent2:#78f0d0;--stroke:rgba(255,255,255,.08);--glow:0 0 0 1px rgba(120,240,208,.15),0 8px 24px rgba(0,0,0,.45),inset 0 1px 0 rgba(255,255,255,.05)}*{box-sizing:border-box}html,body{height:100%}body{margin:0;color:var(--ink);font:15px/1.6 Inter,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Helvetica,Arial;background:radial-gradient(1300px 920px at 20% -10%,rgba(93,213,255,.22),transparent 45%),radial-gradient(980px 760px at 88% 118%,rgba(120,240,208,.20),transparent 45%),linear-gradient(180deg,var(--bg0),var(--bg1))}.container{max-width:1240px;margin:28px auto 100px;padding:0 18px}.card{background:var(--glass);backdrop-filter:blur(14px) saturate(120%);-webkit-backdrop-filter:blur(14px) saturate(120%);border:1px solid var(--stroke);border-radius:18px;padding:18px;box-shadow:var(--glow)}.ghost{background:transparent;border:1px solid var(--stroke)}.row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}.grid{display:grid;gap:16px}.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.title{font-size:24px;font-weight:900;color:#dff6ff;text-shadow:0 1px 0 rgba(255,255,255,.06)}.logoTxt{font-weight:900;letter-spacing:.3px;color:#dff6ff;cursor:pointer;font-size:22px;display:flex;align-items:center;gap:10px}.appLogo{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at 35% 20%,#bff8ff 0%,#5dd5ff 40%,#2a7e9a 75%,#0b2633 100%);box-shadow:0 0 0 1px rgba(93,213,255,.45),0 6px 18px rgba(0,0,0,.55) inset;font-size:18px}.muted{color:var(--muted)}.small{font-size:12px;color:var(--muted)}label{font-weight:700;color:#dbe8ff;display:block;margin-bottom:6px}.pill{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;background:rgba(10,16,26,.35);color:#cfe3ff;border:1px solid var(--stroke)}input,textarea{width:100%;padding:12px 14px;border-radius:14px;border:1px solid var(--stroke);color:var(--ink);background:rgba(10,16,26,.45);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);font-size:15px}input[type=number]{text-align:right}select{appearance:none;-webkit-appearance:none;-moz-appearance:none;width:100%;padding:12px 44px 12px 14px;border-radius:14px;border:1px solid var(--stroke);color:var(--ink);background:rgba(10,16,26,.45) no-repeat right 12px center;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23a8b6d6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>');background-size:18px 18px}option{background:#0c1422;color:#eaf1ff}.btn{cursor:pointer;border:1px solid var(--stroke);color:var(--ink);padding:12px 16px;border-radius:14px;font-weight:800;letter-spacing:.2px;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));box-shadow:var(--glow);transition:transform .12s ease,box-shadow .12s ease}.btn:hover{box-shadow:0 0 0 1px rgba(93,213,255,.35),0 12px 36px rgba(0,0,0,.5)}.btn:active{transform:translateY(1px)}.btn.brand{border-color:rgba(93,213,255,.35);background:linear-gradient(180deg,rgba(93,213,255,.28),rgba(120,240,208,.18));box-shadow:0 0 0 1px rgba(93,213,255,.4),0 10px 28px rgba(93,213,255,.2)}.btn.link{border:none;background:transparent;padding:4px 6px;color:#9fb2d9;font-size:12px}table{width:100%;border-collapse:collapse}th,td{padding:12px 10px}thead th{color:#e9f5ff;text-align:left;font-size:13px;letter-spacing:.2px;border-bottom:1px solid var(--stroke)}tbody td{border-bottom:1px solid rgba(255,255,255,.05)}tfoot td{font-weight:900}.right{text-align:right}
/* ===== Preview ONLY â€” high readability ===== */
#printArea{background:#ffffff;border-radius:16px;padding:16px;border:1px solid #e4e9f5;color:#0b1220}
#printArea .miniCard{background:#f7f9ff;border:1px solid #d9e1f3;border-radius:12px;padding:12px;color:#0b1220}
#printHeader{background:linear-gradient(180deg,#1a2235,#131a2a);color:#ffffff;padding:12px;border-radius:12px;margin:-6px -6px 12px -6px;display:flex;align-items:center;justify-content:space-between}
#printArea thead th{color:#0b1220}
#p_table th,#p_table td{color:#0b1220;border-bottom:1px solid #e6ecf7}
#memoLabel{color:#0b1220;font-weight:700}
#memoBox{border-radius:12px;padding:10px;min-height:120px;background:#f7faff;border:1px solid #e1e9f8;color:#0b1220}
#p_subtotal,#p_complexAmt,#p_marginAmt,#p_vatAmt,#p_grand{color:#0b1220;font-weight:700}
/* ===== Modals â€” keep centered & above all ===== */
.modal{display:none;position:fixed;inset:0;background:rgba(3,6,10,.55);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);align-items:center;justify-content:center;z-index:9999}
@media print{body{background:#fff;color:#000}.no-print{display:none!important}#printArea{box-shadow:none;background:#fff}}
footer{margin-top:60px;padding:40px 0;text-align:center;color:#9fb2d9;border-top:1px solid rgba(255,255,255,0.08);font-size:13px}.error{border-color:#ff5a7a!important;box-shadow:0 0 0 2px rgba(255,90,122,.15) inset}
</style></head><body><div class="container"><div class="row" style="justify-content:space-between;align-items:center"><div class="logoTxt" id="brandName"><span class="appLogo" aria-hidden="true">ğŸ“„</span><span id="brandText">FrameQuote</span></div><div class="row"><button class="btn" id="btnProTop">Pro</button><button class="btn" id="btnLoginOpen">ë¡œê·¸ì¸</button></div></div><div class="grid cols-4 card" style="margin-top:16px"><div><label id="lblClient">Client / Project</label><input id="client"/></div><div><label id="lblDate">Date</label><input id="date" type="date"/></div><div><label id="lblUILang">UI Language</label><select id="uiLang"><option value="ko">í•œêµ­ì–´</option><option value="en" selected>English</option><option value="ja">æ—¥æœ¬èª</option></select></div><div><label id="lblCurrency">Currency</label><select id="currency"><option value="KRW">â‚© KRW</option><option value="USD" selected>$ USD</option><option value="GBP">Â£ GBP</option><option value="AUD">A$ AUD</option><option value="CAD">CA$ CAD</option><option value="EUR">â‚¬ EUR</option><option value="JPY">Â¥ JPY</option></select><div id="fxStatus" class="small"></div></div><div><label id="lblPreset">Project Type (Preset)</label><select id="preset"></select></div><div><label id="lblVAT">VAT (%)</label><input id="vat" type="number" value="10" min="0" max="30"/></div><div><label id="lblProps">Props (%)</label><select id="propsLevel"><option value="0">0%</option><option value="5">5%</option><option value="10">10%</option><option value="15">15%</option></select></div><div><label id="lblArt">Art/Set (%)</label><select id="artLevel"><option value="0">0%</option><option value="7">7%</option><option value="12">12%</option><option value="20">20%</option></select></div><div><label id="lblLoc">Location (%)</label><select id="locLevel"><option value="0">0%</option><option value="5">5%</option><option value="10">10%</option><option value="15">15%</option></select></div></div><div class="card" style="margin-top:16px"><div class="row" style="justify-content:space-between;align-items:center;gap:12px"><div class="row" style="gap:10px"><span class="pill" id="lblItems">Items</span><span class="small muted" id="lblHint">Add labor, gear, studio, post, props, art, locationâ€¦</span></div><div class="row no-print" style="gap:8px"><button class="btn" id="add">+ <span id="btnAddTxt">Add</span></button><button class="btn" id="clear"><span id="btnClearTxt">Clear</span></button><button class="btn" id="btnProps">Props</button><button class="btn" id="btnArt">Art</button><button class="btn" id="btnLoc">Location</button><button class="btn" id="btnTalent">Talent</button><button class="btn" id="btnMakeup">Makeup</button></div></div><div style="overflow:auto;margin-top:10px"><table id="items"><thead><tr><th style="width:20%" id="thCat">Category</th><th id="thDesc">Description</th><th class="right" style="width:14%" id="thUnit">Unit</th><th class="right" style="width:10%" id="thQty">Qty</th><th class="right" style="width:16%" id="thSub">Subtotal</th><th class="no-print" style="width:64px" id="thDel">Del</th></tr></thead><tbody id="itemsBody"></tbody><tfoot><tr><td colspan="4" class="right" id="tfSubtotal">Subtotal</td><td class="right" id="subtotal">0</td><td class="no-print"></td></tr><tr><td colspan="4" class="right" id="tfComplex">Complexity Weight (<span id="cPctView">0</span>%)</td><td class="right" id="complexAmt">0</td><td class="no-print"></td></tr><tr><td colspan="4" class="right" id="tfMargin">Margin (<span id="mPct">15</span>%)</td><td class="right" id="marginAmt">0</td><td class="no-print"></td></tr><tr><td colspan="4" class="right" id="tfVAT">VAT (<span id="vPct">10</span>%)</td><td class="right" id="vatAmt">0</td><td class="no-print"></td></tr><tr><td colspan="4" class="right" id="tfTotal">Total</td><td class="right" id="grand">0</td><td class="no-print"></td></tr></tfoot></table></div></div><div class="grid cols-2" style="margin-top:16px"><div class="card"><label id="lblNotes">Notes / Scope / Exclusions</label><textarea id="notes" rows="6"></textarea></div><div class="card"><label id="lblVendor">Vendor Info</label><textarea id="vendor" rows="6"></textarea></div></div><div id="printArea" class="card" style="margin-top:18px"><div id="printHeader" class="row"><div class="row" style="gap:8px;align-items:center"><span class="appLogo" id="pdfBrandIcon">ğŸ“„</span><div><div class="small" id="printLabel">PDF ë¯¸ë¦¬ë³´ê¸°</div><h2 id="p_title" style="margin:4px 0 2px">QUOTATION</h2><div class="small" id="p_client">Client</div><div class="small" id="p_date">YYYY-MM-DD</div></div></div><div id="p_vendor" class="small" style="white-space:pre-line;text-align:right"></div></div><table id="p_table"><thead><tr><th id="p_thCat">Category</th><th id="p_thDesc">Description</th><th class="right" id="p_thUnit">Unit</th><th class="right" id="p_thQty">Qty</th><th class="right" id="p_thSub">Subtotal</th></tr></thead><tbody></tbody></table><div class="grid cols-2" style="gap:12px;margin-top:10px"><div><div class="small" id="memoLabel" style="margin-bottom:6px">Notes / Scope / Exclusions</div><div id="memoBox" aria-readonly="true"></div></div><div class="miniCard"><div class="row" style="justify-content:space-between"><div id="p_tfSubtotal">Subtotal</div><div id="p_subtotal" class="right">0</div></div><div class="row" style="justify-content:space-between"><div>Complexity (<span id="p_cPct">0</span>%)</div><div id="p_complexAmt" class="right">0</div></div><div class="row" style="justify-content:space-between"><div>Margin (<span id="p_mPct">15</span>%)</div><div id="p_marginAmt" class="right">0</div></div><div class="row" style="justify-content:space-between"><div>VAT (<span id="p_vPct">10</span>%)</div><div id="p_vatAmt" class="right">0</div></div><hr style="border:none;border-top:1px solid #e0e6f6;margin:6px 0"/><div class="row" style="justify-content:space-between"><div><b id="p_tfTotal">Total</b></div><div id="p_grand" class="right"><b>0</b></div></div></div></div><div class="row" style="justify-content:space-between;margin-top:10px"><div class="small" id="p_leftBrand">FrameQuote</div><div class="small" style="font-weight:900">STONFILM</div></div></div><div class="row no-print" style="justify-content:flex-end;margin-top:10px"><button class="btn brand" id="btnPrint">PDF</button></div><div class="card no-print" style="margin-top:16px"><div class="row" style="justify-content:space-between;align-items:center"><div class="title" id="proTitle">FrameQuote Pro</div><button class="btn brand" id="btnUpgrade">Upgrade</button></div></div><div class="modal" id="loginModal" style="display:none"><div class="card" style="width:min(640px,95vw)"><div class="row" style="justify-content:space-between;align-items:center"><div class="title" id="loginTitle">Login</div><button class="btn ghost" id="loginClose">âœ–</button></div><div class="grid cols-2" style="margin-top:10px"><div><label id="lblEmail">Email</label><input id="authEmail" autocomplete="username" placeholder="name@example.com"/></div><div><label id="lblPass">Password</label><input id="authPass" type="password" autocomplete="current-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"/></div></div><div class="row" style="gap:8px;margin-top:12px"><button class="btn brand" id="btnLogin">Login</button><button class="btn brand" id="btnGoogle">Login with Google</button></div><div class="row" style="gap:8px;margin-top:8px;align-items:center"><button class="btn ghost" id="btnOpenSignup">Sign up</button><button class="btn link" id="btnForgotPass">Forgot Password</button></div></div></div><div class="modal" id="signupModal" style="display:none"><div class="card" style="width:min(720px,96vw)"><div class="row" style="justify-content:space-between;align-items:center"><div class="title" id="signupTitle">Sign up & Subscribe</div><button class="btn ghost" id="signupClose">âœ–</button></div><div class="grid cols-3" style="margin-top:10px"><div><label id="lblGender">Gender</label><select id="sgGender"><option value="male">Male</option><option value="female">Female</option><option value="other">Other</option></select></div><div><label id="lblPhone">Phone</label><input id="sgPhone" placeholder="+82-10-0000-0000"/></div><div><label id="lblRole">Role</label><select id="sgRole"><option value="company">Company</option><option value="student">Student</option><option value="freelancer">Freelancer</option><option value="other">Other</option></select></div></div><div class="grid cols-3" style="margin-top:10px"><div><label id="lblEmail2">Email</label><input id="sgEmail" placeholder="name@example.com"/></div><div><label id="lblVerify">Verification Code</label><div class="row"><input id="sgCode" placeholder="123456" style="flex:1"/><button class="btn" id="btnSendCode">Send</button></div></div><div><label id="lblPassword">Password</label><input id="sgPass" type="password"/></div></div><div class="grid cols-2" id="roleExtras" style="margin-top:10px"></div><div class="grid cols-2" style="margin-top:10px"><div><label id="lblPassConfirm">Confirm Password</label><input id="sgPass2" type="password"/></div></div><div class="card" style="margin-top:10px"><div class="row" style="justify-content:space-between;align-items:center"><div><b id="lblCardReg">Card for auto-charge</b> <span class="small" id="lblCardHint">$5 every 30 days</span></div><button class="btn brand" id="btnSubscribe">Subscribe</button></div><div class="small muted" id="lblCardDesc">Redirect to secure checkout (stub). After subscribing, Pro features unlock automatically.</div></div></div></div><div class="modal" id="upgradeModal" style="display:none"><div class="card" style="width:min(640px,95vw)"><div class="row" style="justify-content:space-between;align-items:center"><div class="title" id="upgradeTitle">FrameQuote Pro</div><button class="btn ghost" id="upgradeClose">âœ–</button></div><div class="small" id="upgradeDesc" style="margin-top:6px">$5 billed every 30 days. Cancel anytime. "ê´‘ê³ ì œê±°" ê°€ëŠ¥. PDFì—ì„œ ëª¨ë“  ë¡œê³  ì œê±°ë©ë‹ˆë‹¤.</div><ul class="small" style="line-height:1.9;margin:10px 0"><li id="f1">Unlimited presets (cloud)</li><li id="f2">Team share & read-only links</li><li id="f3">Export XLSX / PPTX / DOCX / CSV</li><li id="f4">Brand logo/themes, version history</li></ul><div class="row" style="gap:8px;justify-content:flex-end"><button class="btn" id="btnUpLogin">Login</button><button class="btn brand" id="btnUpSignup">Sign up</button></div></div></div></div><footer><div style="font-weight:900;margin-bottom:6px">STONFILM</div><div>Powered by STONFILM â€” Creative AI & VFX Studio</div><div style="margin-top:4px;color:#7c8aa5">Â© 2025 STONFILM. All rights reserved.</div></footer><script>const $=(q,ctx=document)=>ctx.querySelector(q),$$=(q,ctx=document)=>Array.from(ctx.querySelectorAll(q));const fmt2=n=>Math.round((n+Number.EPSILON)*100)/100;let proMode=false,localeUI='ko',currency='USD',marginPct=15;const safe=(el,cb)=>{if(el)cb(el)};const setText=(sel,txt)=>{const el=$(sel);if(el)el.textContent=txt};const setHTML=(sel,html)=>{const el=$(sel);if(el)el.innerHTML=html};const I18N={en:{brand:'FrameQuote',client:'Client / Project',date:'Date',ui:'UI Language',preset:'Project Type (Preset)',currency:'Currency',vat:'VAT (%)',items:'Items',hint:'Add labor, gear, studio, post, props, art, locationâ€¦',cat:'Category',desc:'Description',unit:'Unit',qty:'Qty',sub:'Subtotal',del:'Del',subtotal:'Subtotal',complex:'Complexity Weight',margin:'Margin',vatlabel:'VAT',total:'Total',add:'Add',clear:'Clear',props:'Props (%)',art:'Art/Set (%)',loc:'Location (%)',notes:'Notes / Scope / Exclusions',vendor:'Vendor Info',quotation:'QUOTATION',pro:'FrameQuote Pro',login:'Login',loginWithGoogle:'Login with Google',signup:'Sign up',forgot:'Forgot Password',email:'Email',password:'Password',passConfirm:'Confirm Password',gender:'Gender',phone:'Phone',role:'Role',verification:'Verification Code',send:'Send',cardReg:'Card for auto-charge',cardHint:'$5 every 30 days',cardDesc:'Redirect to secure checkout (stub). After subscribing, Pro features unlock automatically.',subscribe:'Subscribe',upgradeTitle:'FrameQuote Pro',upgradeDesc:'$5 billed every 30 days. Cancel anytime. Ad removal. Logos removed from PDF.',company:'Company',student:'Student',freelancer:'Freelancer',other:'Other',signupDone:'Sign-up completed.',pdfPreview:'PDF Preview'},ko:{brand:'í”„ë ˆì„ì¿¼íŠ¸',client:'ê³ ê° / í”„ë¡œì íŠ¸',date:'ë‚ ì§œ',ui:'UI ì–¸ì–´',preset:'í”„ë¡œì íŠ¸ ìœ í˜•(í”„ë¦¬ì…‹)',currency:'í†µí™”',vat:'ë¶€ê°€ì„¸(%)',items:'í•­ëª©',hint:'ì¸ê±´ë¹„, ì¥ë¹„, ìŠ¤íŠœë””ì˜¤, í›„ë°˜, ì†Œí’ˆÂ·ë¯¸ìˆ Â·ë¡œì¼€ì´ì…˜ ë“± ì¶”ê°€',cat:'ì¹´í…Œê³ ë¦¬',desc:'ì„¤ëª…',unit:'ë‹¨ê°€',qty:'ìˆ˜ëŸ‰',sub:'ì†Œê³„',del:'ì‚­ì œ',subtotal:'ì†Œê³„',complex:'ë³µì¡ë„ ê°€ì¤‘ì¹˜',margin:'ë§ˆì§„',vatlabel:'ë¶€ê°€ì„¸',total:'ì´ì•¡',add:'ì¶”ê°€',clear:'ì´ˆê¸°í™”',props:'ì†Œí’ˆ(%)',art:'ë¯¸ìˆ /ì„¸íŠ¸(%)',loc:'ë¡œì¼€ì´ì…˜(%)',notes:'íŠ¹ì´ì‚¬í•­ / ë‚©í’ˆë²”ìœ„ / ì œì™¸',vendor:'ê³µê¸‰ì ì •ë³´',quotation:'ê²¬ì ì„œ',pro:'í”„ë ˆì„ì¿¼íŠ¸ Pro',login:'ë¡œê·¸ì¸',loginWithGoogle:'êµ¬ê¸€ë¡œ ë¡œê·¸ì¸',signup:'íšŒì›ê°€ì…',forgot:'ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°',email:'ì´ë©”ì¼',password:'ë¹„ë°€ë²ˆí˜¸',passConfirm:'ë¹„ë°€ë²ˆí˜¸ í™•ì¸',gender:'ì„±ë³„',phone:'ì—°ë½ì²˜',role:'êµ¬ë¶„',verification:'ì¸ì¦ì½”ë“œ',send:'ë°œì†¡',cardReg:'ìë™ê²°ì œìš© ì¹´ë“œ',cardHint:'30ì¼ë§ˆë‹¤ $5',cardDesc:'ì•ˆì „í•œ ê²°ì œ í˜ì´ì§€ë¡œ ì´ë™(ë°ëª¨). êµ¬ë… í›„ Pro ê¸°ëŠ¥ì´ ì—´ë¦½ë‹ˆë‹¤.',subscribe:'êµ¬ë…',upgradeTitle:'í”„ë ˆì„ì¿¼íŠ¸ Pro',upgradeDesc:'30ì¼ë§ˆë‹¤ $5 ê²°ì œ. ì–¸ì œë“  í•´ì§€. ê´‘ê³ ì œê±° ë° PDF ë¡œê³  ì œê±°.',company:'íšŒì‚¬',student:'í•™ìƒ',freelancer:'í”„ë¦¬ëœì„œ',other:'ê¸°íƒ€',signupDone:'íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.',pdfPreview:'PDF ë¯¸ë¦¬ë³´ê¸°'},ja:{brand:'ãƒ•ãƒ¬ãƒ¼ãƒ ã‚¯ã‚©ãƒ¼ãƒˆ',client:'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ / ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ',date:'æ—¥ä»˜',ui:'UI è¨€èª',preset:'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¤ãƒ—(ãƒ—ãƒªã‚»ãƒƒãƒˆ)',currency:'é€šè²¨',vat:'æ¶ˆè²»ç¨(%)',items:'é …ç›®',hint:'äººä»¶è²»ãƒ»æ©Ÿæãƒ»ã‚¹ã‚¿ã‚¸ã‚ªãƒ»ãƒã‚¹ãƒˆãƒ»å°é“å…·ãƒ»ç¾è¡“ãƒ»ãƒ­ã‚±ãªã©',cat:'ã‚«ãƒ†ã‚´ãƒª',desc:'èª¬æ˜',unit:'å˜ä¾¡',qty:'æ•°é‡',sub:'å°è¨ˆ',del:'å‰Šé™¤',subtotal:'å°è¨ˆ',complex:'è¤‡é›‘åº¦ä¿‚æ•°',margin:'ãƒãƒ¼ã‚¸ãƒ³',vatlabel:'æ¶ˆè²»ç¨',total:'åˆè¨ˆ',add:'è¿½åŠ ',clear:'ã‚¯ãƒªã‚¢',props:'å°é“å…·(%)',art:'ç¾è¡“/ã‚»ãƒƒãƒˆ(%)',loc:'ãƒ­ã‚±(%)',notes:'å‚™è€ƒ / ç¯„å›² / é™¤å¤–',vendor:'ä¾›çµ¦è€…æƒ…å ±',quotation:'è¦‹ç©æ›¸',pro:'FrameQuote Pro',login:'ãƒ­ã‚°ã‚¤ãƒ³',loginWithGoogle:'Googleã§ãƒ­ã‚°ã‚¤ãƒ³',signup:'ç™»éŒ²',forgot:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸ',email:'ãƒ¡ãƒ¼ãƒ«',password:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',passConfirm:'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª',gender:'æ€§åˆ¥',phone:'é›»è©±',role:'åŒºåˆ†',verification:'ç¢ºèªã‚³ãƒ¼ãƒ‰',send:'é€ä¿¡',cardReg:'è‡ªå‹•èª²é‡‘ã‚«ãƒ¼ãƒ‰',cardHint:'30æ—¥ã”ã¨ $5',cardDesc:'å®‰å…¨ãªæ±ºæ¸ˆãƒšãƒ¼ã‚¸ã¸(ãƒ‡ãƒ¢)ã€‚è³¼èª­å¾Œã«Proæ©Ÿèƒ½ãŒè§£æ”¾ã€‚',subscribe:'è³¼èª­',upgradeTitle:'FrameQuote Pro',upgradeDesc:'30æ—¥ã”ã¨$5ã€‚ã„ã¤ã§ã‚‚è§£ç´„å¯ã€‚åºƒå‘Šé™¤å»ãƒ»PDFãƒ­ã‚´å‰Šé™¤ã€‚',company:'ä¼šç¤¾',student:'å­¦ç”Ÿ',freelancer:'ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹',other:'ãã®ä»–',signupDone:'ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚',pdfPreview:'PDF ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼'}};const PRESET_TEXT={ko:{custom:'ì‚¬ìš©ì ì •ì˜',shorts:'ì„¸ë¡œ ìˆí¼(1ë¶„ ì´í•˜)',youtube:'ìœ íŠœë¸Œ ê´‘ê³ (15â€“30ì´ˆ)',mv:'ë®¤ì§ë¹„ë””ì˜¤(1ì¼ ì´¬ì˜)',cf:'TVC/CF(1â€“3ë¶„, 2ì¼)',event:'ì´ë²¤íŠ¸/ë¼ì´ë¸Œ',threeD:'3D ì• ë‹ˆë©”ì´ì…˜(ì„¸ê·¸ë¨¼íŠ¸)',long10:'ë¡±í¼ 10ë¶„',long30:'ë¡±í¼ 30ë¶„',long60:'ë¡±í¼ 60ë¶„'},en:{custom:'Custom',shorts:'Vertical Shorts (â‰¤1m)',youtube:'YouTube Ads (15â€“30s)',mv:'Music Video (1-day shoot)',cf:'TVC/CF (1â€“3m, 2 days)',event:'Event / Live',threeD:'3D Animation (segment)',long10:'Long-form 10m',long30:'Long-form 30m',long60:'Long-form 60m'},ja:{custom:'ã‚«ã‚¹ã‚¿ãƒ ',shorts:'ç¸¦å‹ã‚·ãƒ§ãƒ¼ãƒˆ (ã€œ1åˆ†)',youtube:'YouTube åºƒå‘Š (15â€“30ç§’)',mv:'ãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯ãƒ“ãƒ‡ã‚ª (1æ—¥æ’®å½±)',cf:'TVC/CF (1â€“3åˆ†ãƒ»2æ—¥)',event:'ã‚¤ãƒ™ãƒ³ãƒˆ / ãƒ©ã‚¤ãƒ–',threeD:'3D ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ (ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ)',long10:'ãƒ­ãƒ³ã‚°ãƒ•ã‚©ãƒ¼ãƒ  10åˆ†',long30:'ãƒ­ãƒ³ã‚°ãƒ•ã‚©ãƒ¼ãƒ  30åˆ†',long60:'ãƒ­ãƒ³ã‚°ãƒ•ã‚©ãƒ¼ãƒ  60åˆ†'}};const PRESET_KEYS=['custom','shorts','youtube','mv','cf','event','threeD','long10','long30','long60'];function t(k){return I18N[localeUI]?.[k]||I18N.en[k]||k}function rebuildPresets(){const sel=$('#preset');if(!sel)return;const prev=sel.value;sel.innerHTML='';const map=PRESET_TEXT[localeUI]||PRESET_TEXT.en;PRESET_KEYS.forEach(k=>{const opt=document.createElement('option');opt.value=k;opt.textContent=map[k]||k;sel.appendChild(opt)});sel.value=PRESET_KEYS.includes(prev)?prev:'custom'}function applyI18n(){document.documentElement.lang=localeUI;setText('#brandText',t('brand'));const lo=$('#btnLoginOpen');if(lo&&lo.textContent!=='Logout'&&lo.textContent!=='ë¡œê·¸ì•„ì›ƒ')lo.textContent=t('login');setText('#lblClient',t('client'));setText('#lblDate',t('date'));setText('#lblUILang',t('ui'));setText('#lblPreset',t('preset'));setText('#lblCurrency',t('currency'));setText('#lblVAT',t('vat'));setText('#lblItems',t('items'));setText('#lblHint',t('hint'));setText('#thCat',t('cat'));setText('#thDesc',t('desc'));setText('#thUnit',t('unit'));setText('#thQty',t('qty'));setText('#thSub',t('sub'));setText('#thDel',t('del'));setText('#tfSubtotal',t('subtotal'));setHTML('#tfComplex',`${t('complex')} (<span id="cPctView">${$('#cPctView')?$('#cPctView').textContent:0}</span>%)`);setHTML('#tfMargin',`${t('margin')} (<span id="mPct">${$('#mPct')?$('#mPct').textContent:15}</span>%)`);setHTML('#tfVAT',`${t('vatlabel')} (<span id="vPct">${$('#vPct')?$('#vPct').textContent:10}</span>%)`);setText('#tfTotal',t('total'));setText('#btnAddTxt',t('add'));setText('#btnClearTxt',t('clear'));setText('#lblProps',t('props'));setText('#lblArt',t('art'));setText('#lblLoc',t('loc'));setText('#lblNotes',t('notes'));setText('#lblVendor',t('vendor'));setText('#printLabel',t('pdfPreview'));setText('#p_title',t('quotation'));setText('#p_thCat',t('cat'));setText('#p_thDesc',t('desc'));setText('#p_thUnit',t('unit'));setText('#p_thQty',t('qty'));setText('#p_thSub',t('sub'));setText('#p_tfSubtotal',t('subtotal'));setText('#p_tfTotal',t('total'));setText('#memoLabel',t('notes'));setText('#proTitle',t('pro'));setText('#loginTitle',t('login'));setText('#btnLogin',t('login'));setText('#btnGoogle',t('loginWithGoogle'));setText('#btnOpenSignup',t('signup'));setText('#btnForgotPass',t('forgot'));setText('#lblEmail',t('email'));setText('#lblPass',t('password'));setText('#signupTitle',t('signup'));setText('#lblEmail2',t('email'));setText('#lblPassword',t('password'));setText('#lblPassConfirm',t('passConfirm'));setText('#lblGender',t('gender'));setText('#lblPhone',t('phone'));setText('#lblRole',t('role'));setText('#lblVerify',t('verification'));setText('#btnSendCode',t('send'));setText('#lblCardReg',t('cardReg'));setText('#lblCardHint',t('cardHint'));setText('#lblCardDesc',t('cardDesc'));setText('#btnSubscribe',t('subscribe'));setText('#upgradeTitle',t('upgradeTitle'));setText('#upgradeDesc',t('upgradeDesc'));setText('#btnUpLogin',t('login'));setText('#btnUpSignup',t('signup'));const role=$('#sgRole');if(role&&role.options.length>=4){role.options[0].text=t('company');role.options[1].text=t('student');role.options[2].text=t('freelancer');role.options[3].text=t('other')}setText('#p_leftBrand',t('brand'));rebuildPresets()}const FX={base:'KRW',rates:{KRW:1,USD:0.00074,EUR:0.00067,JPY:0.11,GBP:0.00057,AUD:0.00112,CAD:0.00102}};function fxKRWtoSel(v){return(FX.rates[currency]||1)*(v||0)}function money(n){const v=fmt2(n);try{return new Intl.NumberFormat(localeUI==='ko'?'ko-KR':localeUI,{style:'currency',currency}).format(v)}catch(e){return(currency==='KRW'?'â‚©':currency)+' '+v.toLocaleString()}}function setFxStatus(msg,isError=false){const el=$('#fxStatus');if(!el)return;el.textContent=msg||'';el.style.color=isError?'#ff8aa3':'#86a0c5'}function refreshRates(){const key='FX_CACHE_V1';try{const cached=JSON.parse(localStorage.getItem(key)||'null');if(cached&&Date.now()-cached.ts<1000*60*60*6&&cached.rates){Object.assign(FX.rates,cached.rates);setFxStatus('Using cached FX')}}catch{}fetch('https://api.exchangerate.host/latest?base=KRW&symbols=USD,EUR,JPY,GBP,AUD,CAD').then(r=>r.json()).then(j=>{if(j?.rates){Object.assign(FX.rates,j.rates);localStorage.setItem(key,JSON.stringify({ts:Date.now(),rates:FX.rates}));setFxStatus('Rates updated');calc()}}).catch(()=>{setFxStatus('FX update failed â€” cached/default used',true);calc()})}function addRow(row={cat:t('cat'),desc:'',price:0,qty:1}){const tr=document.createElement('tr');const tdCat=document.createElement('td');const iCat=document.createElement('input');iCat.value=row.cat||'';tdCat.appendChild(iCat);const tdDesc=document.createElement('td');const iDesc=document.createElement('input');iDesc.value=row.desc||'';tdDesc.appendChild(iDesc);const tdUnit=document.createElement('td');tdUnit.className='right';const iUnit=document.createElement('input');iUnit.type='number';iUnit.value=Number(row.price||0);tdUnit.appendChild(iUnit);const tdQty=document.createElement('td');tdQty.className='right';const iQty=document.createElement('input');iQty.type='number';iQty.value=Number(row.qty||1);tdQty.appendChild(iQty);const tdSub=document.createElement('td');tdSub.className='right subtotal';tdSub.textContent='0';const tdDel=document.createElement('td');tdDel.className='no-print';const b=document.createElement('button');b.className='btn btnDel';b.textContent='âœ–';tdDel.appendChild(b);tr.append(tdCat,tdDesc,tdUnit,tdQty,tdSub,tdDel);$('#itemsBody')?.appendChild(tr);calc()}function presetFill(type){const body=$('#itemsBody');if(!body)return;body.innerHTML='';const add=arr=>arr.forEach(addRow);const L={planning:{ko:'ê¸°íš',en:'Planning',ja:'ä¼ç”»'},shooting:{ko:'ì´¬ì˜',en:'Shooting',ja:'æ’®å½±'},gear:{ko:'ì¥ë¹„',en:'Gear',ja:'æ©Ÿæ'},post:{ko:'í›„ë°˜',en:'Post',ja:'ãƒã‚¹ãƒˆ'},studio:{ko:'ìŠ¤íŠœë””ì˜¤',en:'Studio',ja:'ã‚¹ã‚¿ã‚¸ã‚ª'},makeup:{ko:'ë©”ì´í¬ì—…',en:'Makeup',ja:'ãƒ¡ã‚¤ã‚¯'},talent:{ko:'ë°°ìš°/ëª¨ë¸/ì•„í‹°ìŠ¤íŠ¸',en:'Talent',ja:'ã‚¿ãƒ¬ãƒ³ãƒˆ'}};const w=k=>L[k]?.[localeUI]||L[k]?.en||k;if(type==='shorts')add([{cat:w('planning'),price:200000,qty:1},{cat:w('shooting'),price:300000,qty:1},{cat:w('gear'),price:200000,qty:1},{cat:w('post'),price:300000,qty:1}]);else if(type==='youtube')add([{cat:w('planning'),price:300000,qty:1},{cat:w('shooting'),price:500000,qty:1},{cat:w('gear'),price:400000,qty:1},{cat:w('post'),price:400000,qty:1}]);else if(type==='mv')add([{cat:w('planning'),price:700000,qty:1},{cat:w('shooting'),price:1200000,qty:1},{cat:w('gear'),price:900000,qty:1},{cat:w('studio'),price:700000,qty:1},{cat:w('post'),price:1200000,qty:1},{cat:w('makeup'),price:200000,qty:1}]);else if(type==='cf')add([{cat:w('planning'),price:2000000,qty:1},{cat:w('shooting'),price:3500000,qty:2},{cat:w('gear'),price:3000000,qty:2},{cat:w('studio'),price:2500000,qty:1},{cat:w('post'),price:4000000,qty:1},{cat:w('makeup'),price:400000,qty:1},{cat:w('talent'),price:800000,qty:2}]);else if(type==='event')add([{cat:w('shooting'),price:800000,qty:1},{cat:w('gear'),price:700000,qty:1},{cat:t('cat'),price:300000,qty:2},{cat:w('post'),price:400000,qty:1}]);else if(type==='threeD')add([{cat:t('cat'),desc:'Lookdev/Pipeline',price:1500000,qty:1},{cat:t('cat'),desc:'Assets',price:1500000,qty:2},{cat:t('cat'),desc:'Animation',price:500000,qty:10},{cat:w('post'),desc:'Comp/Sound',price:1500000,qty:1}]);else if(type==='long10')add([{cat:w('planning'),price:1500000,qty:1},{cat:w('shooting'),price:2000000,qty:2},{cat:w('gear'),price:1800000,qty:2},{cat:w('studio'),price:1200000,qty:1},{cat:w('makeup'),price:400000,qty:1},{cat:w('talent'),price:800000,qty:2},{cat:w('post'),price:2500000,qty:1}]);else if(type==='long30')add([{cat:w('planning'),price:3000000,qty:1},{cat:w('shooting'),price:4000000,qty:4},{cat:w('gear'),price:3500000,qty:3},{cat:w('studio'),price:2500000,qty:2},{cat:w('makeup'),price:1200000,qty:1},{cat:w('talent'),price:2500000,qty:3},{cat:w('post'),price:6000000,qty:1}]);else if(type==='long60')add([{cat:w('planning'),price:6000000,qty:1},{cat:w('shooting'),price:8000000,qty:6},{cat:w('gear'),price:7000000,qty:4},{cat:w('studio'),price:4500000,qty:3},{cat:w('makeup'),price:2500000,qty:1},{cat:w('talent'),price:5000000,qty:4},{cat:w('post'),price:12000000,qty:1}]);else addRow();calc()}function calc(){const rows=$$('#itemsBody tr');let subtotal=0;rows.forEach(tr=>{const[cat,desc,price,qty]=$$('input',tr);const s=(parseFloat(price?.value||0)*parseFloat(qty?.value||0));subtotal+=s;const subcell=$('.subtotal',tr);if(subcell)subcell.textContent=money(fxKRWtoSel(s))});const propsPct=parseFloat($('#propsLevel')?.value||0);const artPct=parseFloat($('#artLevel')?.value||0);const locPct=parseFloat($('#locLevel')?.value||0);const cPct=propsPct+artPct+locPct;setText('#cPctView',cPct);const base=subtotal+subtotal*(cPct/100);const marginAmt=base*(marginPct/100);const vatPct=parseFloat($('#vat')?.value||0);const vatAmt=(base+marginAmt)*(vatPct/100);const grand=base+marginAmt+vatAmt;setText('#subtotal',money(fxKRWtoSel(subtotal)));setText('#complexAmt',money(fxKRWtoSel(subtotal*(cPct/100))));setText('#marginAmt',money(fxKRWtoSel(marginAmt)));setText('#vatAmt',money(fxKRWtoSel(vatAmt)));setText('#grand',money(fxKRWtoSel(grand)));const tbody=$('#p_table tbody');if(tbody){tbody.innerHTML='';rows.forEach(tr=>{const[cat,desc,price,qty]=$$('input',tr);const s=(parseFloat(price?.value||0)*parseFloat(qty?.value||0));const pr=document.createElement('tr');const td1=document.createElement('td');td1.textContent=cat?.value||'';const td2=document.createElement('td');td2.textContent=desc?.value||'';const td3=document.createElement('td');td3.className='right';td3.textContent=money(fxKRWtoSel(parseFloat(price?.value||0)));const td4=document.createElement('td');td4.className='right';td4.textContent=qty?.value||0;const td5=document.createElement('td');td5.className='right';td5.textContent=money(fxKRWtoSel(s));pr.append(td1,td2,td3,td4,td5);tbody.appendChild(pr)})}setText('#p_client',$('#client')?.value||t('client'));setText('#p_date',$('#date')?.value||new Date().toISOString().slice(0,10));setText('#memoBox',$('#notes')?.value||'');setText('#p_vendor',$('#vendor')?.value||'');setText('#p_cPct',cPct);setText('#p_mPct',$('#mPct')?.textContent||'15');setText('#p_vPct',vatPct);setText('#p_subtotal',$('#subtotal')?.textContent||'0');setText('#p_complexAmt',$('#complexAmt')?.textContent||'0');setText('#p_marginAmt',$('#marginAmt')?.textContent||'0');setText('#p_vatAmt',$('#vatAmt')?.textContent||'0');setText('#p_grand',$('#grand')?.textContent||'0')}function toast(msg){const t=document.createElement('div');t.id='toast';t.textContent=msg;document.body.appendChild(t);setTimeout(()=>t.classList.add('show'),10);setTimeout(()=>{t.classList.remove('show');t.remove()},1800)}function openModal(id){const el=$(id);if(el){el.style.display='flex'}}function closeModal(id){const el=$(id);if(el){el.style.display='none'}}function afterLogin(email){closeModal('#loginModal');const bar=$('#btnLoginOpen')?.parentElement;if(!bar)return;const mail=document.createElement('div');mail.className='small';mail.textContent=email;bar.insertBefore(mail,$('#btnLoginOpen'));setText('#btnLoginOpen',localeUI==='ko'?'ë¡œê·¸ì•„ì›ƒ':'Logout');$('#btnLoginOpen').onclick=()=>location.reload()}function bind(){const today=new Date().toISOString().slice(0,10);const dateEl=$('#date');if(dateEl)dateEl.value=today;const brand=$('#brandName');if(brand)brand.onclick=()=>location.reload();const proTop=$('#btnProTop');if(proTop)proTop.onclick=()=>openModal('#upgradeModal');const upBtn=$('#btnUpgrade');if(upBtn)upBtn.onclick=()=>openModal('#upgradeModal');const loginOpen=$('#btnLoginOpen');if(loginOpen)loginOpen.onclick=()=>openModal('#loginModal');const loginClose=$('#loginClose');if(loginClose)loginClose.onclick=()=>closeModal('#loginModal');const openSignup=$('#btnOpenSignup');if(openSignup)openSignup.onclick=()=>{closeModal('#loginModal');openModal('#signupModal')};const signupClose=$('#signupClose');if(signupClose)signupClose.onclick=()=>closeModal('#signupModal');const upgradeClose=$('#upgradeClose');if(upgradeClose)upgradeClose.onclick=()=>closeModal('#upgradeModal');const btnLogin=$('#btnLogin');if(btnLogin)btnLogin.onclick=()=>afterLogin($('#authEmail')?.value||'user@example.com');const btnGoogle=$('#btnGoogle');if(btnGoogle)btnGoogle.onclick=()=>afterLogin('google-user@example.com');const upLogin=$('#btnUpLogin');if(upLogin)upLogin.onclick=()=>{closeModal('#upgradeModal');openModal('#loginModal')};const upSignup=$('#btnUpSignup');if(upSignup)upSignup.onclick=()=>{closeModal('#upgradeModal');openModal('#signupModal')};const subscribe=$('#btnSubscribe');if(subscribe)subscribe.onclick=()=>{toast('Redirecting to card page (stub)');setTimeout(()=>{closeModal('#signupModal');toast(t('signupDone'))},800)};const sendCode=$('#btnSendCode');if(sendCode)sendCode.onclick=()=>toast('Verification code sent');const uiSel=$('#uiLang');if(uiSel)uiSel.onchange=e=>{localeUI=e.target.value; if(!I18N[localeUI]) localeUI='en'; applyI18n();calc()};const curSel=$('#currency');if(curSel)curSel.onchange=e=>{currency=e.target.value;calc()};['#vat','#propsLevel','#artLevel','#locLevel','#notes','#vendor'].forEach(id=>{const el=$(id);if(!el)return;el.addEventListener(id==='#notes'?'input':'change',calc)});const add=$('#add');if(add)add.onclick=()=>addRow();const clear=$('#clear');if(clear)clear.onclick=()=>{$('#itemsBody').innerHTML='';calc()};const bProps=$('#btnProps');if(bProps)bProps.onclick=()=>addRow({cat:t('props'),price:200000,qty:1});const bArt=$('#btnArt');if(bArt)bArt.onclick=()=>addRow({cat:t('art'),price:300000,qty:1});const bLoc=$('#btnLoc');if(bLoc)bLoc.onclick=()=>addRow({cat:t('loc'),price:200000,qty:1});const bTalent=$('#btnTalent');if(bTalent)bTalent.onclick=()=>addRow({cat:'Talent',price:500000,qty:1});const bMake=$('#btnMakeup');if(bMake)bMake.onclick=()=>addRow({cat:'Makeup',price:200000,qty:1});const body=$('#itemsBody');if(body){body.addEventListener('click',e=>{if(e.target.classList.contains('btnDel')){e.target.closest('tr').remove();calc()}});body.addEventListener('input',e=>{if(e.target.tagName==='INPUT')calc()})}const preset=$('#preset');if(preset)preset.onchange=e=>presetFill(e.target.value);const printBtn=$('#btnPrint');if(printBtn)printBtn.onclick=()=>window.print()}function init(){localeUI=$('#uiLang')?.value||'en';if(!I18N[localeUI])localeUI='en';currency=$('#currency')?.value||'USD';applyI18n();rebuildPresets();presetFill('custom');bind();refreshRates();calc();smokeTest()}function smokeTest(){const ids=['#fxStatus','#memoLabel','#lblNotes','#lblVendor','#p_table','#p_title','#p_leftBrand'];const missing=ids.filter(s=>!$(s));if(missing.length){console.warn('Missing elements:',missing)}else{console.log('UI check OK')}addRow({cat:'Test',price:1000,qty:2});const g=$('#grand')?.textContent||'';if(!g||g==='0'){console.warn('Calc check: total not updated')}else{console.log('Calc check OK:',g)}}document.addEventListener('DOMContentLoaded',init);</script><!-- Supabase JS CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
/** 1) í™˜ê²½ê°’ (ë„ˆì˜ í”„ë¡œì íŠ¸ ê²ƒìœ¼ë¡œ ë°”ê¿” ë„£ê¸°) **/
const SUPABASE_URL = 'https://YOUR-PROJECT.supabase.co';   // â† Settings > API ì˜ Project URL
const SUPABASE_ANON_KEY = 'YOUR-ANON-PUBLIC-KEY';          // â† anon public key
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/** 2) ì—˜ë¦¬ë¨¼íŠ¸ ìºì‹œ (ì´ë¯¸ HTMLì— ìˆëŠ” idë“¤ì— ë§ì¶¤) **/
const $ = (q) => document.querySelector(q);
const emailInput   = $('#sgEmail');      // ì´ë©”ì¼
const otpInput     = $('#sgCode');       // ì¸ì¦ì½”ë“œ 6ìë¦¬
const passInput    = $('#sgPass');       // ë¹„ë°€ë²ˆí˜¸
const pass2Input   = $('#sgPass2');      // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
const sendBtn      = $('#btnSendCode');  // "ë°œì†¡" ë²„íŠ¼
const subscribeBtn = $('#btnSubscribe'); // "êµ¬ë…" ë²„íŠ¼ (ê²°ì œ í›„ ê°€ì… ì™„ë£Œ ë²„íŠ¼ ì—­í• )
const loginOpenBtn = $('#btnLoginOpen'); // ë¡œê·¸ì¸ ì—´ê¸° ë²„íŠ¼(ìˆìœ¼ë©´)

/** UXìš© í† ìŠ¤íŠ¸ */
function toast(msg, ok=false){
  const t=document.createElement('div');
  t.textContent=msg;
  t.style.cssText='position:fixed;right:16px;bottom:16px;z-index:99999;padding:10px 14px;border-radius:10px;color:#fff;'+
                  (ok?'background:#22c55e;':'background:#ef4444;');
  document.body.appendChild(t);
  setTimeout(()=>t.remove(), 2600);
}

/** 3) ì´ë©”ì¼ë¡œ OTP(6ìë¦¬ ì½”ë“œ) ë³´ë‚´ê¸°
 *  Supabase Auth â†’ Email OTP(6) í™œì„±í™” + SMTP(Resend) ì„¸íŒ…ì´ ëë‚˜ ìˆì–´ì•¼ ë™ì‘í•¨
 */
async function sendEmailOtp(){
  const email = (emailInput?.value||'').trim();
  if(!email){ toast('ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”'); return; }

  // ì´ë¯¸ ê°€ì…í•œ ì´ë©”ì¼ì´ë¼ë„ OTP ë¡œê·¸ì¸/í™•ì¸ì€ ë³´ë‚¼ ìˆ˜ ìˆìŒ(ë ˆì´íŠ¸ë¦¬ë°‹ ì£¼ì˜)
  const { data, error } = await supabase.auth.signInWithOtp({
    email,
    options: {
      // ì‚¬ìš©ìê°€ ë§í¬ë¥¼ ëˆŒë €ì„ ë•Œ ëŒì•„ì˜¬ URL (ì„ íƒ)
      emailRedirectTo: 'https://frame-quote.com/#welcome'
    }
  });
  if(error){
    console.error(error);
    toast(error.message || 'ì¸ì¦ì½”ë“œ ë°œì†¡ ì‹¤íŒ¨');
  }else{
    localStorage.setItem('fq_signup_email', email);
    toast('ì¸ì¦ì½”ë“œë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤. ë©”ì¼í•¨ì„ í™•ì¸í•˜ì„¸ìš” âœ…', true);
  }
}

/** 4) ì¸ì¦ì½”ë“œ(6ìë¦¬) ê²€ì¦ + íšŒì› ì •ë³´(ë¹„ë²ˆ) ì„¸íŒ…
 *   - ì´ë©”ì¼ OTPëŠ” "verifyOtp"ë¡œ ê²€ì¦
 *   - ê²€ì¦ ì„±ê³µ í›„ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¸íŒ…(ì²˜ìŒ ê°€ì…í•œ ìœ ì €ëŠ” ê³„ì •ì´ ìƒì„±ë¨)
 */
async function verifyEmailOtpAndSetPassword(){
  const email = (emailInput?.value || localStorage.getItem('fq_signup_email') || '').trim();
  const token = (otpInput?.value||'').trim();
  const pass  = (passInput?.value||'').trim();
  const pass2 = (pass2Input?.value||'').trim();

  if(!email) { toast('ì´ë©”ì¼ì´ ë¹„ì—ˆìŠµë‹ˆë‹¤'); return; }
  if(!token || token.length !== 6) { toast('ì¸ì¦ì½”ë“œ 6ìë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”'); return; }
  if(!pass || pass.length < 6) { toast('ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒ'); return; }
  if(pass !== pass2) { toast('ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤'); return; }

  // 4-1) OTP ê²€ì¦
  const { data: vData, error: vErr } = await supabase.auth.verifyOtp({
    email,
    token,
    type: 'email'  // ì´ë©”ì¼ OTP
  });
  if(vErr){
    console.error(vErr);
    toast(vErr.message || 'ì¸ì¦ì½”ë“œ í™•ì¸ ì‹¤íŒ¨');
    return;
  }

  // 4-2) ë¹„ë°€ë²ˆí˜¸ ì„¤ì •(ë˜ëŠ” ë³€ê²½)
  const { data: uData, error: uErr } = await supabase.auth.updateUser({ password: pass });
  if(uErr){
    console.error(uErr);
    toast(uErr.message || 'ë¹„ë°€ë²ˆí˜¸ ì„¤ì • ì‹¤íŒ¨');
    return;
  }

  // 4-3) í”„ë¡œí•„ í…Œì´ë¸”ì— ê¸°ë³¸ ì •ë³´ ì €ì¥(ìˆìœ¼ë©´ upsert)
  try{
    await supabase.from('profiles')
      .upsert({ user_id: uData.user.id, email, role: $('#sgRole')?.value||null, phone: $('#sgPhone')?.value||null }, { onConflict: 'user_id' });
  }catch(e){ console.warn('profiles upsert warn', e); }

  toast('ì¸ì¦ ì™„ë£Œ! ì´ì œ ê²°ì œë¡œ ì´ë™í•˜ì„¸ìš” âœ…', true);
  // ì—¬ê¸°ì—ì„œ ê²°ì œ í˜ì´ì§€ë¡œ ë³´ë‚¼ ìˆ˜ë„ ìˆìŒ(ì•„ë˜ Stripe ì„¹ì…˜ ì°¸ê³ )
}

/** 5) êµ¬ë…(ê²°ì œ) â†’ ì„±ê³µ í›„ ê°€ì… ìµœì¢… ì™„ë£Œ ì²˜ë¦¬
 *    - ê²°ì œ ì„±ê³µ ë¦¬ë‹¤ì´ë ‰íŠ¸ URLì— ?checkout=success ê°™ì€ ì¿¼ë¦¬ë¡œ ëŒì•„ì˜¤ê²Œ í•˜ê³ 
 *      ê·¸ë•Œ pro=true í”Œë˜ê·¸ë¥¼ ì €ì¥í•´ ì£¼ë©´ ë.
 */
async function finalizeAfterCheckout(){
  const params = new URLSearchParams(location.search);
  if(params.get('checkout') === 'success'){
    const { data: userRes } = await supabase.auth.getUser();
    const user = userRes?.user;
    if(user){
      await supabase.from('profiles').upsert({ user_id: user.id, pro: true }, { onConflict: 'user_id' });
      toast('êµ¬ë…ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰', true);
    }
  }
}

/** 6) ì´ë²¤íŠ¸ ë°”ì¸ë”© */
sendBtn?.addEventListener('click', sendEmailOtp);
subscribeBtn?.addEventListener('click', async () => {
  // (ì„ì‹œ) ê²°ì œ í˜ì´ì§€ë¡œ ì´ë™ â€” ì‹¤ì œ ê²°ì œëŠ” Stripe Checkout ë§í¬/í¬í„¸ë¡œ ë°”ê¿” ë„£ê¸°
  // ì˜ˆ: location.href = 'https://checkout.stripe.com/c/xxx';
  toast('ê²°ì œ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤ (ë°ëª¨)', true);
  // ë°ëª¨ë¼ë©´ ê·¸ëƒ¥ ì¦‰ì‹œ ì™„ë£Œë¡œ ê°€ì •í•´ì„œ ì•„ë˜ ë¼ì¸ì„ ì¼œë„ ë¨:
  // location.href = location.origin + location.pathname + '?checkout=success';
});

// ë¡œê·¸ì¸ ëª¨ë‹¬ì—ì„œ "ë¡œê·¸ì¸" ë²„íŠ¼ ëˆ„ë¥¼ ë•ŒëŠ” signInWithPassword ë“±ì„ ì—°ê²°í•´ë„ ë¨.
// (ë„¤ê°€ ì´ë¯¸ afterLogin(email) ê°™ì€ UI í•¨ìˆ˜ê°€ ìˆìœ¼ë‹ˆ, ì„±ê³µ í›„ ê·¸ê±¸ í˜¸ì¶œí•˜ê²Œ í•˜ë©´ ë¨.)

// ì´ˆê¸° í˜¸ì¶œ
finalizeAfterCheckout();
</script>
</body></html>
